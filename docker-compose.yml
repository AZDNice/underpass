version: '3.3'

networks:
    underpass:
    default:
        driver: bridge

services:
    pritunl:
        image: jippi/pritunl:latest
        container_name: pritunl
        restart: always
        privileged: true
        networks: 
            - underpass
        ports:
            - 80:80
            - 443:443
            - "$PRITUNL_TCP:1194/tcp"
            - "$PRITUNL_TCP:1194/udp"
    
    shadowsocks:
        image: easypi/shadowsocks-libev:latest
        container_name: shadowsocks
        restart: always
        networks: 
            - underpass
        ports:
            - "$SHADOWSOCKS_TCP:8388/tcp"
            - "$SHADOWSOCKS_UDP:8388/udp"
        environment: 
            - METHOD=aes-256-cfb
            - PASSWORD=$SHADOWSOCKS_PASSWORD
    
    squid:
        image: b4tman/squid:latest
        container_name: squid
        restart: always
        networks: 
            - underpass
        ports:
            - "$SQUID_PORT:3128"

    privoxy:
        

    