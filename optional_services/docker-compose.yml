version: '3.3'

networks:
    underpass:

volumes: 
    mariadb: {}
    phpmyadmin: {}
    nginx-proxy-manager: {}

services:
    mariadb:
        image: linuxserver/mariadb:latest
        container_name: mariadb
        restart: unless-stopped
        networks: 
            - underpass
        environment:
            - MYSQL_ROOT_PASSWORD=$MYSQL_ROOT_PASSWORD
            - TZ=$TZ
        volumes: 
            - mariadb:/config
        
    phpmyadmin:
        image: phpmyadmin/phpmyadmin
        container_name: phpmyadmin
        restart: unless-stopped
        networks:
            - underpass
        ports:
            - "$PHPMYADMIN_PORT:80"
        environment:
            - PMA_ARBITRARY=0
            - PMA_HOST=mariadb
        volumes:
            - phpmyadmin:/sessions
    
    rdesktop:
        image: linuxserver/rdesktop
        container_name: rdesktop
        restart: unless-stopped
        privileged: true
        networks:
            - underpass
        ports:
            - "$RDESKTOP_PORT:3389"
        shm_size: "1gb"
        
